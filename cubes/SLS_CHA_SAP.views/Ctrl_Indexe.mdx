WITH MEMBER [1_G_MATERIAL].[1_G_MATERIAL].[TOTAL_MATERIAL].[Σ(Sugar , Solvents , Stevia)] AS SUM({DISTINCT({[1_G_MATERIAL].[1_G_MATERIAL].[D_10], [1_G_MATERIAL].[1_G_MATERIAL].[D_70], [1_G_MATERIAL].[1_G_MATERIAL].[D_85]})}), SOLVE_ORDER = 1, FORMAT_STRING = '#,##0.00;(#,##0.00)' SELECT NON EMPTY {[1_G_PERIOD].[1_G_PERIOD].[CAMP 2023],[1_G_PERIOD].[1_G_PERIOD].[CAMP 2024]}*{DRILLUPMEMBER({[SLS_CHA_SAP_IND].[SLS_CHA_SAP_IND].MEMBERS}, {[SLS_CHA_SAP_IND].[SLS_CHA_SAP_IND].[BALANCE_UNIT], [SLS_CHA_SAP_IND].[SLS_CHA_SAP_IND].[SLS_VOL], [SLS_CHA_SAP_IND].[SLS_CHA_SAP_IND].[BALANCE]})} ON 0, NON EMPTY {TM1SubsetToSet([SLS_Q_HQ].[SLS_Q_HQ],"Default","public")}*{GENERATE({{FILTER(TM1SubsetAll([1_G_MATERIAL].[1_G_MATERIAL]), ([1_G_MATERIAL].[1_G_MATERIAL].CURRENTMEMBER.PROPERTIES("Volume_Unit") = "TO"))}}, {StrToSet(CASE WHEN [1_G_MATERIAL].[1_G_MATERIAL].CURRENTMEMBER.PROPERTIES("MEMBER_NAME") = "D_85" THEN "{[1_G_MATERIAL].[1_G_MATERIAL].[D_85], [1_G_MATERIAL].[1_G_MATERIAL].[Σ(Sugar , Solvents , Stevia)]}" ELSE "{[1_G_MATERIAL].[1_G_MATERIAL].CURRENTMEMBER}" END)})} ON 1 FROM [SLS_CHA_SAP] WHERE ([1_G_PHASE].[1_G_PHASE].[ACT], [1_G_SALES_ORG].[1_G_SALES_ORG].[TOTAL SALES ORG], [1_G_DISTRIB_CHANNEL].[1_G_DISTRIB_CHANNEL].[Total_Cristal_Co], [1_G_VOLUME_UNIT].[1_G_VOLUME_UNIT].[TO], [SLS_CUSTOMER].[SLS_CUSTOMER].[TOTAL_CUSTOMER], [SLS_SALES_GROUP].[SLS_SALES_GROUP].[TOTAL_SALES_GROUP], [SLS_SHIP_POINT].[SLS_SHIP_POINT].[TOTAL_SHIP_POINT], [SLS_SHIP_PLANT].[SLS_SHIP_PLANT].[TOTAL_SHIP_PLANT], [SLS_PROD_PLANT].[SLS_PROD_PLANT].[TOTAL_PROD_PLANT], [SLS_VENDOR].[SLS_VENDOR].[TOTAL_VENDOR], [SLS_PAYER].[SLS_PAYER].[TOTAL_PAYER], [SLS_SOLD_TO].[SLS_SOLD_TO].[TOTAL_SOLD_TO], [SLS_INCOTERM].[SLS_INCOTERM].[TOTAL_INCOTERM])