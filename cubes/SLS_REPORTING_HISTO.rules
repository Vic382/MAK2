#Region System
FEEDSTRINGS;
SKIPCHECK;
#EndRegion

#Calcul des prix unitaires pour les niveaux consolidés
[] = C:  IF( DB('}ElementAttributes_SLS_CHA_SAP_IND',!SLS_REPORTING_IND,'Type_Indicateur') @= 'Prix_Unit',
	DB('SLS_REPORTING',!1_G_PHASE_REP,!1_G_PERIOD,!1_G_SALES_ORG,!1_G_DISTRIB_CHANNEL, !1_G_VOLUME_UNIT,!SLS_SALES_GROUP,!SLS_CUSTOMER,!SLS_MATERIAL_PLAN,!SLS_PAYER, !SLS_SOLD_TO, !SLS_SHIP_POINT, !SLS_SHIP_PLANT, !SLS_PROD_PLANT, !SLS_VENDOR, !SLS_MAT_FREIGHT_GROUP, !SLS_INCOTERM, !SLS_Q_HQ, DB('}ElementAttributes_SLS_CHA_SAP_IND',!SLS_REPORTING_IND,'Valo_Associée'))\(DB('SLS_REPORTING',!1_G_PHASE_REP,!1_G_PERIOD,!1_G_SALES_ORG,!1_G_DISTRIB_CHANNEL, !1_G_VOLUME_UNIT,!SLS_SALES_GROUP,!SLS_CUSTOMER,!SLS_MATERIAL_PLAN,!SLS_PAYER, !SLS_SOLD_TO, !SLS_SHIP_POINT, !SLS_SHIP_PLANT, !SLS_PROD_PLANT, !SLS_VENDOR, !SLS_MAT_FREIGHT_GROUP, !SLS_INCOTERM, !SLS_Q_HQ,'SLS_VOL')),
        STET);

#Calcul du prix unitaire promo
['PROMO_UNIT'] = C: If( ELISANC('SLS_CUSTOMER', 'IC1 - E00095', !SLS_CUSTOMER)=1 % ELISANC('SLS_CUSTOMER', 'IC1 - E00070', !SLS_CUSTOMER) =1 ,['PROMO']\['SLS_VOL'],['PROMO']\['PROMO_VOL']);

feeders;